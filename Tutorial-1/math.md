# 常微分方程分析的基本方法

本文以 Riccati 方程

$$
y' = 1 - y^2
$$

为例，介绍分析常微分方程的几种基本方法。该方程的精确解为 $y(x) = \tanh(x + C)$，其中 $C$ 由初始条件决定。

---

## 1. 多项式逼近（Taylor 级数展开）

在 $x = 0$ 附近，可将解展开为幂级数：

$$
y(x) = \sum_{k=0}^{\infty} a_k x^k
$$

**递推关系推导：**

将 $y = \sum_k a_k x^k$ 代入 $y' = 1 - y^2$，比较 $x^k$ 系数：

- $y' = \sum_{k \geq 1} k a_k x^{k-1}$
- $y^2 = \left(\sum_k a_k x^k\right)^2 = \sum_n \left(\sum_{j=0}^{n} a_j a_{n-j}\right) x^n$

匹配 $x^k$ 系数得：

$$
(k+1) a_{k+1} = -\sum_{j=0}^{k} a_j a_{k-j}, \quad k \geq 1
$$

**边界条件：** 若 $y(0) = 0$，则 $a_0 = 0$，$a_1$ 由 $y'(0) = 1 - y(0)^2 = 1$ 确定，即 $a_1 = 1$。

**特点：**
- 在原点附近精度高，远离原点时发散
- 适合局部分析和短时行为研究

---

## 2. 稳定性分析

### 2.1 平衡点

令 $y' = 0$，得平衡点 $y = \pm 1$。

### 2.2 线性化稳定性

在平衡点 $y^*$ 附近，设 $y = y^* + \epsilon$，线性化得：

$$
\epsilon' = -2y^* \epsilon + O(\epsilon^2)
$$

- **$y^* = 1$（稳定）：** $\epsilon' \approx -2\epsilon$，扰动指数衰减
- **$y^* = -1$（不稳定）：** $\epsilon' \approx 2\epsilon$，扰动指数增长

### 2.3 全局行为

对于任意初值 $y(0) \in (-1, 1)$，解单调递增趋向 $y = 1$；对于 $y(0) > 1$，解单调递减趋向 $y = 1$。而 $y(0) < -1$ 时，解在有限时间内趋向 $-\infty$（爆破）。

**稳定区域图** 直观展示了不同初值对应解的渐近行为。

---

## 3. 渐近稳定速度

### 3.1 主导衰减率

由线性化分析，当 $x \to \infty$ 时：

$$
y(x) - 1 \sim C e^{-2x}
$$

即解以指数速率 $\lambda = 2$ 趋近稳定平衡点。

### 3.2 高阶修正

精确解 $y = \tanh(x + C)$ 可改写为：

$$
y = \frac{1 - e^{-2(x+C)}}{1 + e^{-2(x+C)}} = 1 - \frac{2e^{-2(x+C)}}{1 + e^{-2(x+C)}}
$$

展开得到几何级数形式，显示衰减主要由 $e^{-2x}$ 及其高次幂控制。

---

## 4. 指数逼近（渐近级数展开）

当 $x \to \infty$ 时，将解展开为指数级数：

$$
y(x) = \sum_{k=0}^{N} a_k e^{-kx}
$$

**递推关系推导：**

设 $q = e^{-x}$，则 $y' = -\sum_k k a_k q^k$，$y^2 = \sum_n \left(\sum_{j=0}^{n} a_j a_{n-j}\right) q^n$。

代入 $y' = 1 - y^2$ 并匹配 $q^k$ 系数：

- **$k = 0$：** $a_0^2 = 1 \Rightarrow a_0 = 1$（取稳定解）
- **$k = 1$：** $a_1 = 2a_0 a_1 \Rightarrow a_1 = 0$（强制）
- **$k = 2$：** $a_2$ 为自由参数，由初始条件决定
- **$k \geq 3$：** 递推公式

$$
a_k = -\frac{1}{k - 2} \sum_{j=1}^{k-1} a_j a_{k-j}
$$

**初始条件与 $a_2$ 的关系：**

若 $y(0) = y_0$，则 $C = \text{artanh}(y_0)$，从而：

$$
a_2 = \frac{2(1 - y_0)}{1 + y_0} = 2e^{-2C}
$$

**特点：**
- 在 $x \to \infty$ 时精度高
- 系数可精确递推计算，无需拟合
- 奇数项系数为零（若 $a_1 = 0$）

---

## 5. 方法对比

| 方法 | 适用区域 | 精度 | 计算方式 |
|------|----------|------|----------|
| 多项式逼近 | $x \approx 0$ | 局部高精度 | 递推 |
| 稳定性分析 | 全局定性 | 定性判断 | 线性化 |
| 指数逼近 | $x \to \infty$ | 渐近高精度 | 递推 |

---

## 6. 代码实现

- `poly_approx.jl`：多项式系数递推与可视化
- `stable_region.jl`：稳定区域与不同初值解的演化
- `exp_approx.jl`：指数展开系数递推与渐近逼近
